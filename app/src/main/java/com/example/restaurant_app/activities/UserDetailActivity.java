package com.example.restaurant_app.activities;import android.app.Activity;import android.content.Intent;import android.content.SharedPreferences;import android.os.Bundle;import android.view.View;import android.widget.Button;import android.widget.Switch;import android.widget.TextView;import com.example.restaurant_app.firestore.AddressFirestoreManager;import com.example.restaurant_app.firestore.RestaurantFirestoreManager;import com.example.restaurant_app.firestore.UserFirestoreManager;import com.example.restaurant_app.models.Address;import com.example.restaurant_app.models.Restaurant;import com.example.restaurant_app.models.User;public class UserDetailActivity extends Activity {    private RestaurantFirestoreManager resManager;    private UserFirestoreManager userManager;    private AddressFirestoreManager addressManager;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.user_detail);        resManager = RestaurantFirestoreManager.newInstance();        userManager = UserFirestoreManager.newInstance();        addressManager = AddressFirestoreManager.newInstance();        final String email = getIntent().getExtras().getString("userEmail");        SharedPreferences settings = getSharedPreferences("UserInfo", 0);        String userID = settings.getString("userID", "");        userManager.getUserByEmail(email, new UserFirestoreManager.GetUserByEmailCallback() {            @Override            public void onCallback(final User user) {                ((TextView) findViewById(R.id.userUpdateFirstname)).setText(user.getFirstName());                ((TextView) findViewById(R.id.userUpdateLastname)).setText(user.getLastName());                ((TextView) findViewById(R.id.userUpdateEmail)).setText(user.getEmail());                if (user.getAddress().getAddressId() != "") {                    ((TextView) findViewById(R.id.userUpdateStreet)).setText(user.getAddress().getAddressStreet());                    ((TextView) findViewById(R.id.userUpdateZipCode)).setText(user.getAddress().getAddressZipCode());                    ((TextView) findViewById(R.id.userUpdateCity)).setText(user.getAddress().getAddressCity());                }                if (user.getRestaurant().getRestaurantId() != "") {                    ((TextView) findViewById(R.id.userUpdateRestaurantname)).setText(user.getRestaurant().getRestaurantName());                    ((TextView) findViewById(R.id.userUpdateUstId)).setText(user.getRestaurant().getTaxNumber());                }                if (user.isAdmin()) {                                                                                                           // wrong user -> get user by email from sharePreferences                    findViewById(R.id.isActiveLabel).setVisibility(View.VISIBLE);                    findViewById(R.id.isActiveSwitch).setVisibility(View.VISIBLE);                    ((Switch) findViewById(R.id.isActiveSwitch)).setChecked(user.getIsActive());                }                final Button saveButton = findViewById(R.id.userUpdateSaveButton);                saveButton.setOnClickListener(new View.OnClickListener() {                    @Override                    public void onClick(View v) {                        final String firstName = ((TextView) findViewById(R.id.userUpdateFirstname)).getText().toString();                        final String lastName = ((TextView) findViewById(R.id.userUpdateLastname)).getText().toString();                        final String email = ((TextView) findViewById(R.id.userUpdateEmail)).getText().toString();                        final String street = ((TextView) findViewById(R.id.userUpdateStreet)).getText().toString();                        final String zipCode = ((TextView) findViewById(R.id.userUpdateZipCode)).getText().toString();                        final String city = ((TextView) findViewById(R.id.userUpdateCity)).getText().toString();                        final String restaurantName = ((TextView) findViewById(R.id.userUpdateRestaurantname)).getText().toString();                        final String ustId = ((TextView) findViewById(R.id.userUpdateUstId)).getText().toString();                        Address updateAddress = user.getAddress();                        updateAddress.setAddressStreet(street);                        updateAddress.setAddressZipCode(zipCode);                        updateAddress.setAddressCity(city);                        Restaurant updateRestaurant = user.getRestaurant();                        updateRestaurant.setRestaurantName(restaurantName);                        updateRestaurant.setTaxNumber(ustId);                        user.setEmail(email);                        user.setFirstName(firstName);                        user.setLastName(lastName);                        if (user.isAdmin()){                                                                                                          // wrong user -> get user by email from sharePreferences                            final Boolean isActive = ((Switch) findViewById(R.id.isActiveSwitch)).isChecked();                            user.setIsActive(isActive);                        }                        resManager.updateRestaurant(updateRestaurant);                        addressManager.updateAddress(updateAddress);                        userManager.updateUser(user);                        Intent intent = new Intent(v.getContext(), UserListActivity.class);                        v.getContext().startActivity(intent);                    }                });                final Button deleteButton = findViewById(R.id.userUpdateDeleteButton);                                  // confirm popup                deleteButton.setOnClickListener(new View.OnClickListener() {                    @Override                    public void onClick(View v) {                        if (user.isAdmin() || user == user){                                                                                                          // wrong user -> get user by email from sharePreferences                            resManager.deleteRestaurant(user.getRestaurant().getRestaurantId());                            addressManager.deleteAddress(user.getAddress().getAddressId());                            userManager.deleteUser(user.getUserId());                        }                        Intent intent = new Intent(v.getContext(), UserListActivity.class);                        v.getContext().startActivity(intent);                    }                });            }        });    }}