package com.example.restaurant_app.activities;import android.app.Activity;import android.content.Context;import android.content.Intent;import android.os.Bundle;import android.view.View;import android.widget.Button;import android.widget.TextView;import android.widget.Toast;import com.example.restaurant_app.adapters.SharedPreferencesAdapter;import com.example.restaurant_app.firestore.UserFirestoreManager;import com.example.restaurant_app.models.User;import com.google.gson.Gson;/** * * @author Jonas Mitschke * @content activity for password change */public class PasswordChangeActivity extends Activity {    private UserFirestoreManager userManager;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.password_change);        userManager = UserFirestoreManager.newInstance();        Context context = getBaseContext();        Gson gson = new Gson();        final User curUser = gson.fromJson(SharedPreferencesAdapter.getDefaults("currentUser", context), User.class);        final Button saveButton = findViewById(R.id.passwordUpdateSaveButton);        saveButton.setOnClickListener(new View.OnClickListener() {            @Override            public void onClick(View v) {                final String passwordOld = ((TextView) findViewById(R.id.pwUpdateOldPWText)).getText().toString();                final String passwordNew = ((TextView) findViewById(R.id.pwUpdateNewPWText)).getText().toString();                String checkError = checkError(passwordNew);                if (!checkError.equals("")){                    Toast toast = Toast.makeText(getApplicationContext(), checkError, Toast.LENGTH_LONG);                    toast.show();                }                else {                    final String hashedPassword = User.hashPassword(passwordOld);                    if (curUser.getPassword().compareTo(hashedPassword) == 0) {                        curUser.setPassword(User.hashPassword(passwordNew));                        userManager.updateUser(curUser);                        Gson gson = new Gson();                        String user_json = gson.toJson(curUser);                        Context context = getBaseContext();                        SharedPreferencesAdapter.setDefaults("currentUser", user_json, context);                        Intent intent = new Intent(v.getContext(), OverviewActivity.class);                        v.getContext().startActivity(intent);                    } else {                        Toast toast = Toast.makeText(getApplicationContext(), getResources().getString(R.string.toast_wrong_old_pw), Toast.LENGTH_LONG);                        toast.show();                    }                }            }        });    }    /**     * @content method for checking for errors in user input while updating the password     * @author Simon Rothmann     * @param toCheck   password     * @return errormessage     */    private String checkError(String toCheck){        if (toCheck.equals(""))            return getString(R.string.password_empty);        return "";    }}